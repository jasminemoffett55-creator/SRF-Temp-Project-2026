#set working directory 
setwd("/Users/elizapease/Desktop/WaterTemp/data") 

#install packages 
install.packages(c("tidyverse", "lubridate", "janitor", "ggplot2", "dplyr", "zoo"
)) 

#read in libraries 
library(tidyverse)
library(lubridate)
library(janitor)
library(ggplot2)
library(dplyr)
library(zoo) 

#read in and check csv
WQ2015 <- read_csv("/Users/elizapease/Desktop/WaterTemp/data/WQ2015_clean_FINAL.csv")
glimpse(WQ2015) #take a look 

#clean up column names and check them out
WQ2015 <- WQ2015 %>%
  clean_names() 
names(WQ2015) 

#ensure date column is date object 
WQ2015<- WQ2015 %>%
  mutate(date=as.Date(date, format = "%m/%d/%Y"))

#no need to create datetime col with both date and time bc we only are looking at date here, not averaging all the hours in a day 

# calc daily max 
daily_max_temp <- WQ2015 %>%
  group_by(date) %>%  #group temp values by date 
  summarise(daily_max_temp= max(temperature_c, na.rm= TRUE)) %>% #calc max temp per day, ensure there are no NAs 
  ungroup()

mmwt <- mean(daily_max_temp$daily_max_temp, na.rm=TRUE) #take the mean of daily max vals from within the daily max col 
mmwt #print mmwt 

#make graph 
ggplot(daily_max_temp, aes(x=date, y=daily_max_temp)) + 
  geom_line(color = "blue") +
  geom_hline(yintercept = mmwt, color = "red", linetype = "dashed") +
  labs(
    title = "Daily Max Temperature with MMWT",
    x = "Date",
    y= "Temperature (Â°C)") + theme_minimal()
  


